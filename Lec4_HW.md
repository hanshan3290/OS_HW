# lab1 SPOC思考题
## 各知识点的小练习
描述符特权级DPL、当前特权级CPL和请求特权级RPL的含义是什么？在哪些寄存器中这些字段？对应的访问条件是什么？ (challenge)写出一些简单的小程序（c or asm）来体现这些特权级的区别和联系。
 ```
  + 建议参见链接“ http://blog.csdn.net/better0332/article/details/3416749 ”对特权级的表述，并查阅指令手册。
  - 
 ```
> CPL: 	当前正在执行的代码所在的段的特权级。
> 			存在于cs寄存器的低两位。
> RPL:		进程对段访问的请求权限，每个段选择子有自己的RPL，它说明的是进程对段访问的请求权限。
> 			存在于段选择子中。
> DPL:		规定访问该段的权限级别。
> 			存在于段描述符中。
> 访问条件:	当进程访问一个段时，需要进程特权级检查，一般要求DPL >= max {CPL, RPL} 
> 


比较不同特权级的中断切换时的堆栈变化差别；(challenge)写出一些简单的小程序（c or asm）来显示出不同特权级的的中断切换的堆栈变化情况。

> 内核态中断时，不发生栈切换。栈上需要保存Error Code、EIP、CS、EFLAGS。
> 用户态中断时，发生栈切换。栈上需要保存Error Code、EIP、CS、EFLAGS、ESP、SS。

### v9-cpu的执行过程(challenge)
  1. 参考os*.c，写一个小程序，能够显示在用户态无法执行的所有特权指令，能够显示出不同特权级的的中断切换的堆栈变化情况。
  1. 扩展em.c，可以打印v9-cpu执行的每一条指令和寄存器状态
  1. 扩展em.c，在产生fatal错误后，把这之前执行的n条指令和寄存器状态打印出来
  1. 扩展c.c和em.c，使得可以指定em.c能够跟踪并打印执行程序中对全局变量的读写或修改的指令，以及指令的执行情况
  1. 扩展em.c的debugger功能，可以设置断点
  1. 扩展em.c的debugger功能，可以任意打断当前执行程序的执行，回到debugger
